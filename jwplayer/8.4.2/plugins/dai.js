!function(){var c="dai",f="-1",u="adBreakEnd",d="adError",n="time",s="meta",e="jw-flag-ads",v=Object.assign||function(n){return Array.prototype.slice.call(arguments,1).forEach(function(t){if(t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}),n},r=function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")},a={adcounterdynamic:"Ad __AD_POD_CURRENT__ of __AD_POD_LENGTH__. ",admessage:"This ad will end in xx",apiKey:"",assetKey:"",cmsID:"",cuetext:"Advertisement",debug:!1,liveAdMessage:"Playing Ad",loadingMessage:"Loading",videoID:""},g=function t(i){for(var n in r(this,t),a)if(a.hasOwnProperty(n)){var s=i[n],e=a[n],h=typeof e;if(void 0!==s){if("boolean"!==h&&"number"!==h||(s=o(s)),typeof s!==h)throw new Error("invalid parameter: "+n+" should be a "+h);this[n]=s}else this[n]=e}};function o(t){if("true"===t)return!0;if("false"===t)return!1;var i=parseFloat(t);return isNaN(i)?t:i}var h=null;function m(t){if(h)return h;if(window.google&&google.ima&&google.ima.dai)return h=Promise.resolve();var i=["//","imasdk.googleapis.com/js/sdkloader/ima3_dai.js"];"file:"===document.location.protocol&&i.unshift("https:");var n=new t.scriptloader(i.join(""));return h=n.load().then(function(){})}var l={};function w(t,s){var e=this,i=l[s];return i||(this.jwplayerEntitlements=function(t,i,n){var s={canPlayAds:!0},e=new t.key(i),h=e.edition();if("unlimited"===h)return n(s);var r=e.token(),a=["//","entitlements.jwplayer.com","/",r,".json"];"file:"===window.location.protocol&&a.unshift("https:"),t.ajax(a.join(""),function(t){s.canPlayAds=!t||!t.response||!1!==t.response.canPlayAds,n(s)},function(){n(s)},{timeout:1e4,responseType:"json"})},l[s]=new Promise(function(i,n){e.jwplayerEntitlements(t,s,function(t){t.canPlayAds?i():n({message:"Ad Limit Reached"})})}))}var _=function(){function i(t){r(this,i),this.t=t,this.i={},this.n={},this.s=null}return i.prototype.e=function(t){return b("b"+(p(t)||t.getAdId()),this.i)},i.prototype.h=function(t){return b("b"+p(t)+"a"+t.getAdId(),this.n)},i.prototype.adEventObject=function(t){var i=t||this.s,n={client:c,viewable:this.t.getViewable()};if(!i)return n;this.s=i,n.id=this.e(i),n.adPlayId=this.h(i),n.adtitle=i.getTitle(),n.adsystem=i.getAdSystem(),n.creativetype="application/x-mpegURL",n.linear="linear";var s=i.getAdPodInfo();if(s){var e=s.getTotalAds();1<e&&(n.sequence=s.getAdPosition(),n.podcount=e),n.adposition=function(t){var i=t.getTimeOffset();{if(0===i)return"pre";if(-1===i)return"post"}return"mid"}(s)}return n},i.prototype.clearAd=function(){this.s=null},i}();function b(t,i){if(t){var n=i[t];return n||(i[t]=(s=12,n=new Array(s+1).join((Math.random().toString(36)+"00000000000000000").slice(2,18)).slice(0,s))),n}var s;return f}function p(t){var i=t.getAdPodInfo();return i?(""+i.getTimeOffset()).replace(/[-.]/g,"N"):null}var y=function(){function h(t,i,n,s){var e=this;r(this,h),this.r=t,this.a=i,this.t=n,this.o=new _(n),this.u=[],this.l=n.utils,this.c=n.getContainer(),this.f=null,this.d=null,this.v=-1,this.g=i.cmsID&&i.videoID,this.m=!this.g&&i.assetKey,this.w=null,this._=null,this.b=null,this.p=function(t){e.y(t)},this.k=s}return h.prototype.beforePlay=function(){var t=this;this.d||this.A()||(clearTimeout(this.v),this.v=setTimeout(function(){t.A()||t.T()},"3000"),this.w=this.t.getConfig().mediaElement,this.d=this.t.createInstream().init().setText(this.a.loadingMessage),this.D().catch(function(){t.T()}))},h.prototype.pause=function(){this.w&&this.w.pause()},h.prototype.resume=function(){this.w&&this.w.play()},h.prototype.T=function(){this.A()||(clearTimeout(this.v),this.P())},h.prototype.D=function(){var n=this;return m().then(function(){if(n.A())return null;var t=google.ima.dai.api.StreamEvent.Type;n._=new google.ima.dai.api.StreamManager(n.w),n._.setClickElement(n.k),n.b=[t.CUEPOINTS_CHANGED,t.LOADED,t.AD_BREAK_STARTED,t.AD_BREAK_ENDED,t.STARTED,t.AD_PROGRESS,t.CLICK,t.COMPLETE,t.ERROR],n._.addEventListener(n.b,n.p,!1);var i=void 0;if(n.g)(i=new google.ima.dai.api.VODStreamRequest).contentSourceId=n.a.cmsID,i.videoId=n.a.videoID;else{if(!n.m)throw new Error("Invalid options");(i=new google.ima.dai.api.LiveStreamRequest).assetKey=n.a.assetKey,n.t.off(s,n.j,n),n.t.on(s,n.j,n)}i.apiKey=n.a.apiKey,n._.requestStream(i)})},h.prototype.x=function(t){var i=this.t.getPlaylistItem(this.t.getPlaylistIndex()),n=t.url;i.sources=[v(i.sources[0],{file:n})],this.d&&(this.d.replacePlaylistItem(i),this.T())},h.prototype.y=function(t){var i=this,n=google.ima.dai.api.StreamEvent.Type,s=this.o.adEventObject(t.getAd());switch(t.type){case n.CUEPOINTS_CHANGED:var e=this.u=t.getStreamData().cuepoints;if(e&&e.length){var h=e.filter(function(t){return 0<t.start}).map(function(t){return{begin:t.start,text:i.a.cuetext}});this.t.setCues([]).setCues(h)}break;case n.LOADED:clearTimeout(this.v),this.x(t.getStreamData());break;case n.AD_BREAK_STARTED:this.t.trigger("adBreakStart",s),this.C(!0),this.d.once("destroyed",function(){i.t.trigger(u,s),i.o.clearAd()});break;case n.AD_BREAK_ENDED:this.d.off().once("destroyed",function(){i.t.trigger(u,s),i.o.clearAd()}),this.C(!1);break;case n.STARTED:this.t.trigger("adImpression",s);var r=this.o.adEventObject(null);r.newstate="playing",this.d.setState(r);break;case n.AD_PROGRESS:if(!this.d)return;this.N(t.getStreamData().adProgressData,s);break;case n.CLICK:this.t.trigger("adClick",s),this.t.pause();break;case n.COMPLETE:this.t.trigger("adComplete",s),this.o.clearAd();break;case n.ERROR:var a=t.getStreamData().errorMessage,o=v({id:f,message:"Ad Error: "+a},s);this.t.trigger(d,o),this.o.clearAd()}},h.prototype.O=function(t){if(this.u.length){for(var i=t.position,n=-1,s=0;s<this.u.length&&!(this.u[s].start>i);s++)n=s;-1<n&&!this.u[n].played&&i!==this.u[n].start&&(this.f=i,this.t.seek(this.u[n].start))}},h.prototype.j=function(t){var i=t.metadata;this._&&i&&this._.onTimedMetadata(i)},h.prototype.C=function(t){var i=this;this.t.off(n,this.O,this),t?(this.l.addClass(this.c,e),this.d||(this.d=this.t.createInstream()),this.d.enableAdsMode(),this.m&&this.d.setText(this.a.liveAdMessage),this.d.off(null,null,this).on("instreamClick",function(){i.k.click()},this).on("state",function(t){i.d.setState(t)},this),this.m&&(this.d.on(s,this.j,this),this.j({metadata:this.t.getItemMeta()}))):(this.l.removeClass(this.c,e),this.g&&this.t.on(n,this.O,this),this.P(),this.f&&(this.w.currentTime=this.f,this.f=null))},h.prototype.N=function(t,i){var n=t.currentTime,s=t.duration;if(i.position=n,i.duration=s,this.d.setTime(i),this.g){var e=t.adPosition,h=t.totalAds,r=this.a.admessage||"",a=this.a.adcounterdynamic||"";r=r.replace(/xx/gi,""+Math.ceil(s-n)),1<h&&(r=(a=(a=a.replace(/__AD_POD_CURRENT__/g,""+e)).replace(/__AD_POD_LENGTH__/g,""+h))+r),this.d.setText(r)}},h.prototype.P=function(){this.d&&(this.d.destroy(),this.d=null)},h.prototype.destroy=function(){clearTimeout(this.v),this.A()||(this.t.off(null,null,this),this._&&this._.removeEventListener(this.b,this.p,!1),this.T(),this.a=null,this.w=null,this.t=null,this.r=null)},h.prototype.A=function(){return!this.r},h}();(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(c,"8.0",function(s,t,e){var i=s.utils,n=s.getConfig(),h=new g(t||{}),r=void 0;m(i).catch(i.noop);var a=n.key;function o(){r&&(r.destroy(),r=null)}this.version="0.4.1",v(this,s.Events),s.pauseAd=function(t){t="boolean"!=typeof t||t,r&&(t?r.pause():r.resume())},s.on("ready",function(){m(i).catch(function(){s.getAdBlock()&&l("Ad playback blocked by an ad blocker",2e4)}),u.catch(function(t){l("Ad Error: "+t.message,60002)})},this).on("playlistItem",function(t){o();var i=t.item,n=v({},h,i.daiSetting);(n.cmsID&&n.videoID||n.assetKey)&&(i.preload="none",r=new y(i,n,s,e),s.once("beforePlay",r.beforePlay,r))},this).on("destroyPlugin",o,this);var u=w.call(this,i,a);function l(t,i){o(),s.off(null,null,this),s.trigger(d,{id:f,client:c,message:t,code:900,adErrorCode:i,tag:""})}u.catch(i.noop),this.destroy=o})}();
